<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.36.1" />
  <meta name="author" content="Josef Spjut">
  <meta name="description" content="Research Scientist">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/hybrid.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-43681956-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="http://josef.spjut.me/index.xml" type="application/rss+xml" title="Josef Spjut">
  <link rel="feed" href="http://josef.spjut.me/index.xml" type="application/rss+xml" title="Josef Spjut">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="http://josef.spjut.me/teaching/2013/10/03/fsm-vs-english/">

  

  <title>FSM vs. English | Josef Spjut</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Josef Spjut</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/research/">
            
            <span>Research</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/media/">
            
            <span>Media</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/games/">
            
            <span>Games</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/misc/">
            
            <span>Miscellaneous</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">FSM vs. English</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2013-10-03 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Oct 3, 2013
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/teaching">teaching</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/lecture">lecture</a
    >, 
    
    <a href="/tags/class">class</a
    >, 
    
    <a href="/tags/verilog">verilog</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fjosef.spjut.me%2fteaching%2f2013%2f10%2f03%2ffsm-vs-english%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=FSM%20vs.%20English&amp;url=http%3a%2f%2fjosef.spjut.me%2fteaching%2f2013%2f10%2f03%2ffsm-vs-english%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fjosef.spjut.me%2fteaching%2f2013%2f10%2f03%2ffsm-vs-english%2f&amp;title=FSM%20vs.%20English"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=http%3a%2f%2fjosef.spjut.me%2fteaching%2f2013%2f10%2f03%2ffsm-vs-english%2f&amp;title=FSM%20vs.%20English"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=FSM%20vs.%20English&amp;body=http%3a%2f%2fjosef.spjut.me%2fteaching%2f2013%2f10%2f03%2ffsm-vs-english%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>Yesterday, I managed to put together the in-class demo
<a href="/post/2013-10-01-interactive-lecture">I discussed previously</a>.
In this post I&rsquo;d like to give a brief explanation of what I showed and
how it demonstrates the proper use of SystemVerilog to describe a
finite state machine (FSM).</p>

<p>What I saw many students doing in their 3rd lab, was to use an English
language description of the behavior they wanted that they translated
directly to behavioral SystemVerilog.
This is a fundamentally different procedure than I had intented to
teach in the class, which was to take the English description of the
behavior they want, and translate it to a FSM.
The next step is to use that FSM and describe it using a standard
SystemVerilog implementation.
This includes 2 pieces of combinational logic, and a single sequential
state register.</p>

<p>For this finite state machine, I describe what happens to a student when he or she sleeps.
First, let&rsquo;s say that a student can be happy, very happy, unhappy, or very unhappy.
Whenever that student sleeps, happiness increases until it saturates at very happy.
If a student doesn&rsquo;t sleep, then happiness decreases until it is empty at very unhappy.
When the student is happy, or very happy, the student will smile.
The following examples are implementations of this description.</p>

<p>The first thing I showed in my demo is the following behavioral
description based on the English description:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-systemverilog" data-lang="systemverilog"><span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 1</span><span style="color:#66d9ef">module</span> student_beh (<span style="color:#66d9ef">input</span> <span style="color:#66d9ef">logic</span> sleep, clk, <span style="color:#66d9ef">output</span> <span style="color:#66d9ef">logic</span> smile);
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 2</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 3</span><span style="color:#66d9ef">logic</span> [<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] happiness;
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 4</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 5</span><span style="color:#66d9ef">initial</span> happiness <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b10</span>;
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 6</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 7</span><span style="color:#66d9ef">always_ff</span> @(<span style="color:#66d9ef">posedge</span> clk) <span style="color:#66d9ef">begin</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 8</span>	<span style="color:#66d9ef">if</span> (sleep) <span style="color:#66d9ef">begin</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79"> 9</span>		<span style="color:#66d9ef">if</span> (happiness <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b11</span>) <span style="color:#75715e">// if sleeping not fully happy, increase happiness
</span><span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">10</span><span style="color:#75715e"></span>			happiness <span style="color:#f92672">=</span> happiness <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b01</span>;
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">11</span>	<span style="color:#66d9ef">end</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">12</span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">begin</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">13</span>		<span style="color:#66d9ef">if</span> (happiness <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b00</span>) <span style="color:#75715e">// if not sleeping decrease happiness
</span><span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">14</span><span style="color:#75715e"></span>			happiness <span style="color:#f92672">=</span> happiness <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b01</span>;
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">15</span>	<span style="color:#66d9ef">end</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">16</span>	
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">17</span>	<span style="color:#66d9ef">if</span> (happiness <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b10</span>) <span style="color:#66d9ef">begin</span> smile <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">end</span> <span style="color:#75715e">// when happy, smile
</span><span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">18</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">else</span>  <span style="color:#66d9ef">begin</span> smile <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>; <span style="color:#66d9ef">end</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">19</span><span style="color:#66d9ef">end</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">20</span><span style="color:#66d9ef">endmodule</span>
<span style="margin-right:0.4em;padding:00.4em00.4em;color:#7c7c79">21</span></code></pre></div>

<p>This module synthesized into the following RTL circuit diagram:</p>

<p><img src="/img/blog/images/2013/10/BEH.png" alt="Failed FSM" /></p>

<p>The next implementation I displayed uses a traditional FSM description
in SystemVerilog:</p>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-systemverilog" data-lang="systemverilog"><span style="color:#66d9ef">module</span> student_fsm (<span style="color:#66d9ef">input</span> <span style="color:#66d9ef">logic</span> sleep, clk, <span style="color:#66d9ef">output</span> <span style="color:#66d9ef">logic</span> smile);
<span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">logic</span> [<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] {VU, UU, HH, VH} statetype;
statetype state, nextstate;

<span style="color:#66d9ef">always_ff</span> @(<span style="color:#66d9ef">posedge</span> clk) <span style="color:#75715e">// State register
</span><span style="color:#75715e"></span>	state <span style="color:#f92672">&lt;=</span> nextstate;

<span style="color:#66d9ef">always_comb</span> <span style="color:#75715e">// next state logic
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">case</span>(state)
		VU:	nextstate <span style="color:#f92672">=</span> sleep <span style="color:#f92672">?</span> UU <span style="color:#f92672">:</span> VU;
		UU:	nextstate <span style="color:#f92672">=</span> sleep <span style="color:#f92672">?</span> HH <span style="color:#f92672">:</span> VU;
		HH:	nextstate <span style="color:#f92672">=</span> sleep <span style="color:#f92672">?</span> VH <span style="color:#f92672">:</span> UU;
		VH:	nextstate <span style="color:#f92672">=</span> sleep <span style="color:#f92672">?</span> VH <span style="color:#f92672">:</span> HH;
		<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> nextstate <span style="color:#f92672">=</span> HH;
	<span style="color:#66d9ef">endcase</span>
	
<span style="color:#66d9ef">assign</span> smile <span style="color:#f92672">=</span> (state <span style="color:#f92672">==</span> HH <span style="color:#f92672">|</span> state <span style="color:#f92672">==</span> VH); <span style="color:#75715e">// output logic
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">endmodule</span>
</code></pre></div></p>

<p>This module syntheizes into a much nicer looking FSM as shown:</p>

<p><img src="/img/blog/images/2013/10/FSM.png" alt="Good FSM" /></p>

<p>The first synthesis results sorta resemble an FSM, but are prone to
bugs and inconsistent behavior, and led many students to spend much
more time than they should have on the first lab assignment.
The second synthesis results show exactly an FSM, and if we translated
our English to an FSM diagram before starting to code, then we will
easily be able to match our FSM to the results.
The second technique is very much preferred for any hardware design.</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="http://josef.spjut.me/teaching/2013/10/01/interactive-lecture/"><span
      aria-hidden="true">&larr;</span> Interactive Lecture</a></li>
    

    
    <li class="next"><a href="http://josef.spjut.me/personal/2013/10/07/some-thoughts/">Some Thoughts <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "josefspjut" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2013 - 2018 
      Josef Spjut &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/javascript.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

